<div class="section bg-secondary">
    <h3 class="container">Create new video tags</h3>
</div>
<div class="container">
    <div class="bg-light padding-sm">
            <form class="form" name="formAddVideoTag">
                <div class="form-group">
                    <div class="player-container">
                        <div class="iframe-wrapper res-16by9">   
                            <youtube player-video="playerInfo" frameborder="0"></youtube> 
                        </div>
                    </div>
                    <div
                        ng-model="videoTag.range"
                        ui-slider="{range: true}" 
                        min="0" 
                        max="{{playerInfo.duration}}" 
                        step="{{slider.step}}"
                        use-decimals
                        >
                    </div>

                    <div class="form-group clearfix margin-top">
                        <div class="col-sm-5">

                            <label class="control-label">Start time</label>
                            <div>
                                <div class="btn-group">
                                    <button class="btn btn-default" ng-click="addStartRange(-slider.step)">
                                        <span class="glyphicon glyphicon-minus"></span>
                                    </button>
                                    <span class="btn btn-default disabled" >{{videoTag.range[0]| secondsToHours}}</span> 
                                    <button class="btn btn-default" ng-click="addStartRange(slider.step)">
                                        <span class="glyphicon glyphicon-plus"></span>
                                    </button>
                                </div>
                                <button class="btn btn-default" ng-click="setStartRangeNow()">
                                    Start Now
                                </button>
                            </div>
                        </div>

                        <div class="col-sm-5">
                            <label class="control-label">End time</label>
                            <div>
                                <div class="btn-group">
                                    <button class="btn btn-default"  ng-click="addEndRange(-slider.step)">
                                        <span class="glyphicon glyphicon-minus"></span>
                                    </button>
                                    <span class="btn btn-default disabled">{{videoTag.range[1]| secondsToHours}}</span>
                                    <button class="btn btn-default" ng-click="addEndRange(slider.step)">
                                        <span class="glyphicon glyphicon-plus"></span>
                                    </button>
                                </div>
                                <button class="btn btn-default" ng-click="setEndRangeNow()">
                                    End Now  
                                </button>
                            </div>
                        </div>

                        <div class="col-sm-2">
                            <label class="control-label">Duration</label>
                            <div>
                                <span class="text-info btn btn-info disabled">
                                    {{videoTag.range[1] - videoTag.range[0]| number:1}} seconds
                                </span>
                            </div>
                        </div>
                    </div>
                </div>



                <div class="form-group">
                    <!--
                    <div class="col-xs-6">
                        <label for="FormSport">Sport</label>
                        <select ng-model="videoTag.sport_id" 
                                ng-options="sport.id as sport.name for sport in sports"
                                class="form-control"
                                ng-required>
                        </select>
                    </div>

                    <div class="col-xs-6">
                        <label for="FormSport">Category</label>
                        <select ng-model="videoTag.category_id" 
                                ng-options="category.id as category.name for category in categories"
                                class="form-control"
                                ng-required>
                            <option value="snowboard">Snowboard</option>
                        </select>
                    </div>
                    -->
                    <div class="clearfix">
                        <div class="col-sm-5 form-group">
                            <label class="control-label">Sport and category</label>
                            <ui-select 
                                ng-model="videoTag.category" 
                                theme="bootstrap"
                                ng-disabled="disabled"
                                reset-search-input="false"
                                required>
                                <ui-select-match placeholder="Sport and category">{{$select.selected.sport_name}} {{$select.selected.category_name}} </ui-select-match>
                                <ui-select-choices
                                    repeat="category in suggestedCategories"
                                    refresh="refreshSuggestedCategories($select.search)"
                                    refresh-delay="0">
                                    <div class="clearfix">
                                        <div class="col-xs-6">
                                            <span class="">{{category.sport_name}}</span>
                                        </div>
                                        <div class="col-xs-6">
                                            <span class="">{{category.category_name}}</span>
                                        </div>
                                    </div>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                        <div class="col-sm-7 form-group ">
                            <label class="control-label">Trick</label>
                            <ui-select 
                                ng-model="videoTag.tag" 
                                theme="bootstrap"
                                ng-disabled="!videoTag.category"
                                reset-search-input="false"
                                required>
                                <ui-select-match placeholder="Trick name">
                                    {{$select.selected.name}} 
                                </ui-select-match>
                                <ui-select-choices
                                    repeat="tag in suggestedTags"
                                    refresh="refreshSuggestedTags($select.search)"
                                    refresh-delay="500">
                                    <div class="clearfix" ng-if="!tag.is_new">
                                        <div class="col-xs-2">
                                            <span class="">{{tag.sport_name}}</span> <br/>
                                            <span class="">{{tag.category_name}}</span>
                                        </div>
                                        <div class="col-xs-8">
                                            <span class="">{{tag.name}}</span>
                                        </div>
                                        <div class="col-xs-2">
                                            <span>{{tag.count_ref}}</span>
                                        </div>
                                    </div>

                                    <div class="clearfix"  ng-if="tag.is_new">
                                        <div class="col-xs-2">
                                            <span class="">{{tag.sport_name}}</span> <br/>
                                            <span class="">{{tag.category_name}}</span>
                                        </div>
                                        <div class="col-xs-8">
                                            <span class="">{{tag.name}}</span>
                                        </div>
                                        <div class="col-xs-2">
                                            <span>(New!)</span>
                                        </div>
                                    </div>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>
                </div>

                <div class="text-center form-group">
                    <button class="btn btn-success" ng-click="playRange(videoTag.range)">
                        <span class="glyphicon glyphicon-play"></span> Preview
                    </button>
                    <button type="button"
                            ng-attr="{ 'disabled': !formAddVideoTag.$valid }"
                            class="btn btn-primary" 
                            ng-click="addVideoTag(videoTag, videoTag.range)">
                        <span class="glyphicon glyphicon-plus-sign"></span> 
                        Post
                    </button>
                </div>

            </form>

            <div class="bg-info padding-sm form-group">                    
                <p class="text-info">
                    <span class="text-big">Be sure to </span> check that your tag is valid before submiting it. 
                    It must be from the begining to the end of the trick. <br/>
                    Do not add useless foutage, be consise. <br/>
                    Be sure to add a valid trick name too. 
                </p>
            </div>

            <div ng-repeat="videoTag in video.video_tags">
                <div ng-include="'html/VideoTags/item.html'"></div>
            </div>


    </div>

</div>
