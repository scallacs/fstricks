<div class="section bg-secondary">
    <h3 class="container">Add new tricks</h3>
</div>
<div class="container">
    <div class="bg-light padding-sm">

        <form class="form" name="formAddVideoTag" novalidate>
            <div class="">
                <div class="iframe-wrapper res-16by9">   
                    <youtube player-video="playerInfo" frameborder="0"></youtube> 
                </div>
            </div>
            <fieldset ng-disabled="isFormLoading">
                <div class="form-group">
                    <div
                        class="margin-top"
                        ng-model="videoTag.range"
                        ui-slider="{range: true}" 
                        min="0" 
                        max="{{playerInfo.duration}}" 
                        step="{{slider.step}}"
                        use-decimals
                        >
                    </div>

                    <div class="form-group clearfix margin-top">
                        <div class="col-sm-5">

                            <label class="control-label">Start time</label>
                            <div>
                                <div class="btn-group">
                                    <button class="btn btn-default" ng-click="addStartRange(-slider.step)">
                                        <span class="glyphicon glyphicon-minus"></span>
                                    </button>
                                    <span class="btn btn-default disabled" >{{videoTag.range[0]| secondsToHours}}</span> 
                                    <button class="btn btn-default" ng-click="addStartRange(slider.step)">
                                        <span class="glyphicon glyphicon-plus"></span>
                                    </button>
                                </div>
                                <button class="btn btn-default" ng-click="setStartRangeNow()">
                                    Start Now
                                </button>
                            </div>
                        </div>

                        <div class="col-sm-5">
                            <label class="control-label">End time</label>
                            <div>
                                <div class="btn-group">
                                    <button class="btn btn-default"  ng-click="addEndRange(-slider.step)">
                                        <span class="glyphicon glyphicon-minus"></span>
                                    </button>
                                    <span class="btn btn-default disabled">{{videoTag.range[1]| secondsToHours}}</span>
                                    <button class="btn btn-default" ng-click="addEndRange(slider.step)">
                                        <span class="glyphicon glyphicon-plus"></span>
                                    </button>
                                </div>
                                <button class="btn btn-default" ng-click="setEndRangeNow()">
                                    End Now  
                                </button>
                            </div>
                        </div>

                        <div class="col-sm-2">
                            <label class="control-label">Duration</label>
                            <div>
                                <span class="text-info btn btn-info disabled">
                                    {{videoTag.range[1] - videoTag.range[0]| number:1}} seconds
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="clearfix">
                        <div class="col-sm-5 form-group">
                            <label class="control-label">Sport and category</label>
                            <ui-select 
                                ng-model="videoTag.category" 
                                theme="bootstrap"
                                reset-search-input="false"
                                required>
                                <ui-select-match placeholder="Sport and category">{{$select.selected.sport_name}} {{$select.selected.category_name}} </ui-select-match>
                                <ui-select-choices
                                    repeat="category in suggestedCategories"
                                    refresh="refreshSuggestedCategories($select.search)"
                                    refresh-delay="0">
                                    <div class="clearfix">
                                        <div class="col-xs-6">
                                            <span class="">{{category.sport_name}}</span>
                                        </div>
                                        <div class="col-xs-6">
                                            <span class="">{{category.category_name}}</span>
                                        </div>
                                    </div>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                        <div class="col-sm-7 form-group ">
                            <label class="control-label">Trick</label>
                            <ui-select 
                                ng-model="videoTag.tag" 
                                theme="bootstrap"
                                ng-disabled="!videoTag.category"
                                reset-search-input="false"
                                required>
                                <ui-select-match placeholder="Trick name">
                                    <span class="text-bold">{{$select.selected.name}} </span>
                                    <span class="text-muted" ng-if="$select.selected.sport_name">
                                        ({{$select.selected.sport_name}} - {{$select.selected.category_name}})
                                    </span>
                                </ui-select-match>
                                <ui-select-choices
                                    repeat="tag in suggestedTags"
                                    refresh="refreshSuggestedTags($select.search)"
                                    refresh-delay="500">
                                    <div class="clearfix">
                                        <div class="col-xs-10" style="text-transform: capitalize;"  >
                                            <span class="text-bold">{{tag.name}}</span> <br/>
                                            <span class="text-muted">{{tag.sport_name}}</span> - 
                                            <span class="text-muted">{{tag.category_name}}</span>
                                        </div>
                                        <div class="col-xs-2" style="overflow: hidden;" >
                                            <span class="text-big" ng-if="!tag.is_new">{{tag.count_ref}}</span>
                                            <span class="text-big text-warning" ng-if="tag.is_new">New!</span>
                                        </div>
                                    </div>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>
                </div>

                <div ng-if="similarTags.length > 0" class=" form-group">
                    <div class="alert alert-danger"> 
                        <p class="">
                            <span class="glyphicon glyphicon-warning-sign"></span> 
                            You cannot create this tag, their is a similar one that already exists. 
                        </p>
                    </div>
                    <div ng-repeat="videoTag in similarTags">
                        <div ng-include="'html/VideoTags/item.html'"></div>
                    </div>
                </div>
                <div mc-messages></div>
                <div class="text-center form-group">
                    <button class="btn btn-success" ng-click="playRange(videoTag)">
                        <span class="glyphicon glyphicon-play"></span> Preview
                    </button>
                    <button type="button"
                            ng-disabled="!formAddVideoTag.$valid || similarTags.length > 0"
                            class="btn btn-primary" 
                            ng-click="addVideoTag(videoTag, videoTag.range)"
                            >
                        <span class="glyphicon glyphicon-plus-sign"></span> 
                        Post

                        <div ng-loading-icon is-loading="isFormLoading"></div>
                    </button>
                </div>
            </fieldset>

        </form>

        <div class="alert alert-info">                    
            <p class="text-info">
                <span class="text-big">
                    <span class="glyphicon glyphicon-info-sign"></span> 
                    Be sure to 
                </span> check that your tag is valid before submiting it. 
                It must be from the begining to the end of the trick. <br/>
                Do not add useless foutage, be consise. <br/>
                Be sure to add a valid trick name too. 
            </p>
        </div>

        <div class="" ng-if="video.video_tags.length > 0">
            <hr/>
            <h3> Existing tricks </h3>
            <div ng-repeat="videoTag in video.video_tags">
                <div ng-include="'html/VideoTags/item.html'"></div>
            </div>
            
        </div>


    </div>

</div>
